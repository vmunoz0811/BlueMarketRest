<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLUEMARKET</title>
    <link rel="shortcut icon" href="images/logo_BM.png" type="image/x-icon">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/login.css">
    <meta name="theme-color" content="#2091F9">

    <meta name="title" content="BlueMarket">
    <meta name="description"
          content="">


    <meta property="og:type" content="website">
    <meta property="og:url" content="Maria Luisa Enciso, Daniel Alvarado, Valeria Muñoz">
    <meta property="og:title" content="BlueMarket">
    <meta property="og:description"
          content="">
    <meta property="og:image" content="BlueMarket">

    <meta property="twitter:title" content="BlueMarket">
    <meta property="twitter:description"
          content="">
    <meta property="twitter:image" content="BlueMarket">
    <title>Ingresa a tu cuenta</title>
</head>
<body>


<section class="form-register">
    <h4>Ingresa a tu cuenta</h4>
    <form id="login">
        username: <input class="controls" type="text" name="username" id="username"
                         placeholder="Ingrese su nombre de usuario" required/>
        password:<input class="controls" type="password" name="password" id="password"
                        placeholder="Ingrese su Contraseña" required/>
        <input class="button" type="submit" value="Login" id="data">

    </form>
    <script >
        const form = document.querySelector("form")
        form.onsubmit= async (e) => {
            e.preventDefault();

            let username = document.getElementById("username").value;
            let password = document.getElementById("password").value;
            console.log(username)
            try {
                let response = await fetch(`./api/users/${username}`, {
                    method: 'GET',
                    headers: {

                        "Content-Type": "application/JSON",
                    },
                });
                let result = await response.json();

                if(username==result.username&&password==result.password){
                    window.location.href="./Wallet.html";
                }else{
                    window.location.href="./401.html";
                }

            }catch (err) {
                console.log(err);
            }

        }
    </script>
    <p><a href="SignUp.html">¿Todavía no tienes una cuenta?</a></p>
</section>

</body>
</html>